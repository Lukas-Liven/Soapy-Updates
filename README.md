# Soapy-Updates
This project was supervised by Benjamin Monreal at Case Western Reserve University.

This repository hosts my work on an update to the Adaptive Optics Simulation program Soapy, the documentation for which can be found at https://soapy.readthedocs.io/en/latest/index.html

I implemented architecture for the simulation of rectangular apertures  in Soapy, which previously only supported circular lenses.
The GUI can be run by executing "soapy -g <configFilename>" in your Python terminal. This reads in .yaml files into the confParse that I have updated to read new parameters to set rectangular dimensions, check my rect yaml conf file for reference. The confParse file also has documentation for each of the parameters that should be gone over before creating your own configs.

The lens file has new functionality that draws a rectangle based off of the dimensions supplied in the square array of 0s and 1s that is used to map the lens against the atmosphere and in calculations for other components of the apparatus. 
For WFS and DM modules, the calculations were updated to also be done for rectangular dimensions, but only the Shack-Hartmann sensor and Tip-Tilt mirror are expected in implementation for testing at this time. *Note* The apparatus parameters you set must be above a certain threshold for the total size of the simulation you are testing or you will run into a simulation error due to the cases of how edges are dealt with since a lot of the math is based off of rounded edges. Testing other devices will likely require some modification to specifically their functions in the modules, but this should be moderate or able to work already. At the current stage of implementation, the above modules as well as the Reconstruction, Science Camera, and Simulation are able to be constructed and run in the GUI without problem, but any execution will produce nothing upon reaching the GUI code due to the DM mapping in its final visual check encountering some issue in which it ends up returning a square array of all zeroes when trying to calculate the DMShape. All of the other parameters calculated in this file produce somewhat reasonable results when compared to execution of the other included conf files, so that leads me to believe it's an issue with the DM setup in particular, since the values called for use in GUI file seem to be a Dict generated from the DM properties. I haven't been able to prove this to be the case, but I believe that it's an issue with the function in the code that determines nxactuators - it tries to read the dimensions of the lens and maps the number of actuators the mirror should have active to that. From there the DM shape can be constructed, but if there is an error in that initialization then it's going to appear as if there are 0 valid actuators and thus it would make sense as to why there is a lack of information in DM shape. This error leads to warnings upon execution, but shouldn't crash any testrun, so try running a rectangular conf file to see the traceback.
